<!DOCTYPE html>
<!--
To change this license header, choose License Headers in Project Properties.
To change this template file, choose Tools | Templates
and open the template in the editor.
-->
<html>
    <head>
        <title>Stellar Console</title>
        <link rel=StyleSheet href="theme.css" type="text/css">
        <script language="javascript" src="//code.jquery.com/jquery-1.11.2.min.js"></script>
        <script language="javascript" type="text/javascript">

            $(document).ready(function () {

                var starData = function (selectedStar) {
                    $('#starContainer').empty();
                    $.get('star.php', {'selectedStar': selectedStar}, function (data) {
                        $('#starContainer').html(data);
                    });
                };

                var constellationData = function (selectedConstellation) {
                    $('#constellationContainer').empty();
                    $.get('constellation.php', {'selectedConstellation': selectedConstellation}, function (data) {

                        var stellarData = JSON.parse(data);
                        var tableContent = '<table>';
                        tableContent += "<thead>";
                        tableContent += "<tr>";
                        tableContent += "<th>Denomination</th>";
                        tableContent += "<th>Designation</th>";
                        tableContent += "<th>Solar Diameter</th>";
                        tableContent += "<th>Absolute Luminosity</th>";
                        tableContent += "<th>Bolometric Luminosity</th>";
                        tableContent += "</tr>";
                        tableContent += "</thead>";
                        tableContent += "<tbody>"

                        $.each(stellarData, function (i, stellarRecord) {

                            tableContent += '<tr>';

                            $.each(stellarRecord, function (j, stellarAttribute) {
                                tableContent += '<td>' + stellarAttribute + '</td>';
                                console.log(stellarAttribute);
                            });

                            tableContent += '</tr>';

                        });
                        tableContent += "</tbody>";
                        tableContent += "</table>";
                        tableContent += '</table>';

                        $('#constellationContainer').html(tableContent);

                        $('table td:nth-child(1)').each(function () {
                            $(this).click(function () {
                                starData($(this).text());
                            }).addClass('pointer');
                        });

                        $('tbody tr:even').removeClass('odd').addClass('even');
                        $('tbody tr:odd').removeClass('even').addClass('odd');
                        $('table thead th').addClass('header');

                        $('table').each(function () {
                            var constellation = $(this);
                            $('thead th', constellation).each(function (dataField) {

                                var header = $(this);
                                if (header.is('.header')) {
                                    header.addClass('clickable').hover(function () {
                                        header.addClass('hover');
                                    }, function () {
                                        header.removeClass('hover');
                                    });

                                    header.click(function () {
                                        var dataSets = constellation.find('tbody > tr').get();

                                        dataSets.sort(function (a, b) {
                                            var claveA = $(a).children('td').eq(dataField).text().toUpperCase();
                                            var claveB = $(b).children('td').eq(dataField).text().toUpperCase();
                                            if (claveA < claveB)
                                                return -1;
                                            if (claveA > claveB)
                                                return 1;
                                            return 0;

                                        });

                                        $.each(dataSets, function (index, dataSet) {
                                            constellation.children('tbody').append(dataSet);
                                        });

                                        constellation.find('td').removeClass('orderedConstellation');
                                        constellation.find('td').filter(':nth-child(' + (dataField + 1) + ')').addClass('orderedConstellation');

                                    });
                                }
                            });
                        });
                    });
                };

                constellationData("Orionis");
                starData("Giausar");

            });
        </script>
    </head>

    <body>
        <div id="mainContainer">
            <div id="constellationContainer"></div>
            <div id="starContainer"></div>
        </div>
    </body>
</html>
