<!DOCTYPE html>
<!--
To change this license header, choose License Headers in Project Properties.
To change this template file, choose Tools | Templates
and open the template in the editor.
-->
<html>
    <head>
        <title>Stellar Console</title>
        <link rel=StyleSheet href="theme.css" type="text/css">
        <script language="javascript" src="//code.jquery.com/jquery-1.11.2.min.js"></script>
        <script language="javascript" type="text/javascript">

            $(document).ready(function () {

                var starData = function (selectedStar) {
                    $('#starContainer').empty();
                    $.get('star.php', {'selectedStar': selectedStar}, function (data) {
                        alert(data);
                        $('#starContainer').html(data);
                    });
                };

                var constellationData = function (selectedConstellation) {
                    $('#constellationContainer').empty();
                    $.get('constellation.php', {'selectedConstellation': selectedConstellation}, function (data) {
                        $('#constellationContainer').html(data);
                    });
                    
                    $('table td:nth-child(1)').each(function () {
                        $(this).click(function () {
                            alert($(this).text());
                            starData($(this).text());
                        }).addClass('pointer');
                    });

                    $('tbody tr:even').removeClass('odd').addClass('even');
                    $('tbody tr:odd').removeClass('even').addClass('odd');
                    $('table thead th').addClass('header');

                    $('table').each(function () {
                        var constellation = $(this);
                        $('thead th', constellation).each(function (dataField) {

                            var header = $(this);
                            if (header.is('.header')) {
                                header.addClass('clickable').hover(function () {
                                    header.addClass('hover');
                                }, function () {
                                    header.removeClass('hover');
                                });

                                header.click(function () {
                                    var dataSets = constellation.find('tbody > tr').get();
                                    
                                    dataSets.sort(function (a, b) {
                                        var claveA = $(a).children('td').eq(dataField).text().toUpperCase();
                                        var claveB = $(b).children('td').eq(dataField).text().toUpperCase();
                                        if (claveA < claveB)
                                            return -1;
                                        if (claveA > claveB)
                                            return 1;
                                        return 0;
                                        
                                    });

                                    $.each(dataSets, function (index, dataSet) {
                                        constellation.children('tbody').append(dataSet);
                                    });

                                    constellation.find('td').removeClass('orderedConstellation');
                                    constellation.find('td').filter(':nth-child(' + (dataField + 1) + ')').addClass('orderedConstellation');

                                });
                            }
                        });
                    });
                };  
                
                constellationData("Draconis");
                starData("Giausar");
                
            });
        </script>
    </head>

    <body>
        <div id="mainContainer">
            <div id="constellationContainer"></div>
            <div id="starContainer"></div>
        </div>
    </body>
</html>
